/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.ca.ui.Notes");jQuery.sap.require("sap.ca.ui.library");jQuery.sap.require("sap.m.List");sap.m.List.extend("sap.ca.ui.Notes",{metadata:{deprecated:true,publicMethods:["clear","reset"],library:"sap.ca.ui",properties:{"showNoteInput":{type:"boolean",group:"Misc",defaultValue:true},"textMaxLength":{type:"int",group:"Misc",defaultValue:1000},"placeholder":{type:"string",group:"Misc",defaultValue:null}},events:{"addNote":{}}}});sap.ca.ui.Notes.M_EVENTS={'addNote':'addNote'};
/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.require("sap.m.MessageToast");
sap.ca.ui.Notes.prototype.init=function(){if(sap.m.List.prototype.init){sap.m.List.prototype.init.apply(this)}this.textAreaDefaultHeight;this.sFourRowHeight;this.sThreeRowHeight;this._oTextArea=new sap.m.TextArea(this.getId()+"-textarea",{maxLength:this.getTextMaxLength(),placeholder:sap.ca.ui.utils.resourcebundle.getText("notes.addNotePlaceHolder")});this._oTextArea.setParent(this);this._oTextArea.sParentAggregationName="fake";if(jQuery.device.is.phone){this._oTextArea.attachLiveChange(this._liveChangePhoneHeightHandler,this)}else{this._oTextArea.attachLiveChange(this._liveChangeHeightHandler,this)}this._oTextArea.attachLiveChange(this.liveChangeMonitor,this);this._oButton=new sap.m.Button(this.getId()+"-add",{text:sap.ca.ui.utils.resourcebundle.getText("notes.addNoteButton"),type:sap.m.ButtonType.Emphasized,press:jQuery.proxy(function(e){this.fireAddNote({value:this._oTextArea.getValue()});this._oTextArea.setValue('');this._oTextArea.setHeight('auto')},this)});this._oButton.setParent(this);this._oButton.sParentAggregationName="fake"};
sap.ca.ui.Notes.prototype.liveChangeMonitor=function(e){if(e.mParameters.newValue.length===this.getTextMaxLength()){var m=sap.ca.ui.utils.resourcebundle.getText("TextOverlimit",[this.getTextMaxLength()]);sap.m.MessageToast.show(m)}};
sap.ca.ui.Notes.prototype.exit=function(){if(sap.m.List.prototype.exit){sap.m.List.prototype.exit.apply(this)}if(this._oFlexBox){this._oFlexBox.destroy();this._oFlexBox=null}this._oTextArea.destroy();this._oButton.destroy()};
sap.ca.ui.Notes.prototype.setTextMaxLength=function(t){if(t>1000){jQuery.sap.log.warn("Notes maximum length set to "+t+", which is greater than the maximum length allowed. TextMaxLength will be reset to 1000 characters");t=1000}this._oTextArea.setProperty("maxLength",t,true);this.setProperty("textMaxLength",t)};
sap.ca.ui.Notes.prototype.clear=function(){this._oTextArea.setValue("")};
sap.ca.ui.Notes.prototype.reset=function(){this.clear();this._oGrowingDelegate&&this._oGrowingDelegate.reset()};
sap.ca.ui.Notes.prototype.setPlaceholder=function(p){this._oTextArea.setProperty("placeholder",p,true);this.setProperty("placeholder",p)};
sap.ca.ui.Notes.prototype._liveChangeHeightHandler=function(e){var $=this.$().find("textarea");var t=$.get(0);t.style.overflow="hidden";t.style.height="auto";t.style.height=t.scrollHeight+"px"};
sap.ca.ui.Notes.prototype._liveChangePhoneHeightHandler=function(e){var $=this.$().find("textarea");var t=$.get(0);if(!this.textAreaDefaultHeight){this.textAreaDefaultHeight=t.scrollHeight}if(this.textAreaDefaultHeight==t.scrollHeight){$.height(t.scrollHeight);t.style.overflow="hidden"}if(this.textAreaDefaultHeight<t.scrollHeight&&!this.sThreeRowHeight){this.sThreeRowHeight=t.scrollHeight;$.height(t.scrollHeight);t.style.overflow="hidden"}if(this.sThreeRowHeight<t.scrollHeight&&!this.sFourRowHeight&&this.sThreeRowHeight){this.sFourRowHeight=t.scrollHeight;$.height(t.scrollHeight);t.style.overflow="hidden"}if(this.sFourRowHeight<t.scrollHeight&&this.sFourRowHeight&&this.sThreeRowHeight){$.height(this.sFourRowHeight);t.style.overflow="auto"}};
sap.ca.ui.Notes.prototype._getFlexBox=function(){if(!this._oFlexBox){this._oTextArea.setLayoutData(new sap.m.FlexItemData({growFactor:1}));try{this._oFlexBox=new sap.m.HBox({items:[this._oTextArea,this._oButton]})}catch(e){jQuery.sap.log.info("Error is catch because _oTextArea and _oButton are not part of any aggregation on this control, which is ok.")}}return this._oFlexBox};
sap.ca.ui.Notes.prototype.onAfterRendering=function(){if(sap.m.List.prototype.onAfterRendering){sap.m.List.prototype.onAfterRendering.apply(this)}if(sap.ui.Device.browser.internet_explorer&&sap.ui.Device.browser.version==9){var t=this.$().find("textarea");var f=t.parents('.sapMFlexItem').first();f.css('height','auto')}};
