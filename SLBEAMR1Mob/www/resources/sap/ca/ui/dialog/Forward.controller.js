/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.require("sap.ca.ui.utils.resourcebundle");sap.ui.controller("sap.ca.ui.dialog.Forward",{_FORWARD_DIALOG_ID:"DLG_FORWARD",_SEARCH_FIELD_ID:"SFD_FORWARD",_FORWARDER_LIST_ID:"LST_AGENTS",_FORWARDER_ITEM_ID:"ITM_AGENT",onInit:function(){var a=this.getView().byId(this._FORWARDER_LIST_ID);a.bindProperty("showNoData",{path:'/agents',formatter:function(c){return(c===undefined)?false:true}});var b=this.getView().byId(this._FORWARDER_ITEM_ID);b.bindProperty("icon",{path:'ImageURL',formatter:function(u){return(u)?u:"sap-icon://person-placeholder"}});var f=this.getView().byId(this._SEARCH_FIELD_ID);this.getView().byId(this._FORWARD_DIALOG_ID).setInitialFocus(f)},onBeforeOpenDialog:function(){var f=this.getView().byId(this._SEARCH_FIELD_ID);f.setValue("");f.focus();this.getView().byId(this._FORWARD_DIALOG_ID).setInitialFocus(f);this.startExternalSearch=undefined;var d=this.getView().byId(this._FORWARD_DIALOG_ID).getModel();if(d){this.startExternalSearch=d.getProperty("/startExternalSearch")}this.getView().byId(this._FORWARDER_LIST_ID).removeSelections(true)},onStartSearch:function(e){var s=e.getParameters().query;if(s){if(this.startExternalSearch){this.startExternalSearch(s)}else{this.setAgents(null)}}else{this.setAgents(undefined)}},onSelectAgent:function(e){var s=e.getParameters().listItem;if(s&&s.getBindingContext()){this.getView().byId(this._FORWARD_DIALOG_ID).close();var S=s.getBindingContext().getObject();sap.ca.ui.dialog.confirmation.open({question:sap.ca.ui.utils.resourcebundle.getText("forward.question",S.FullName),showNote:true,title:sap.ca.ui.utils.resourcebundle.getText("forward.title"),confirmButtonLabel:sap.ca.ui.utils.resourcebundle.getText("dialog.ok"),agent:S},this.forwardConfirmClose)}},onCancelDialog:function(){var r={bConfirmed:false};sap.ca.ui.dialog.factory.closeDialog("DLG_FORWARD",r)},setAgents:function(a){this.getView().byId(this._FORWARD_DIALOG_ID).getModel().setProperty("/agents",a);this.getView().byId(this._FORWARDER_LIST_ID).rerender()},forwardConfirmClose:function(r){var n={};if(r&&r.isConfirmed){n={bConfirmed:true,sNote:r.sNote,oAgentToBeForwarded:this.agent}}else{n={bConfirmed:false}}sap.ca.ui.dialog.factory.closeDialog("DLG_FORWARD",n)}});
